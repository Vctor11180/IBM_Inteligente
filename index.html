<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>NutriLife</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header class="topbar">
    <div class="brand">
        <div class="logo">ğŸƒ</div>
        <span>NutriLife</span>
    </div>

    <nav>
        <button class="nav-btn active" onclick="mostrarVista('imc')">Calculadora IMC</button>
        <button class="nav-btn" onclick="mostrarVista('reco')">Recomendaciones</button>
        <button class="nav-btn" onclick="mostrarVista('bot')">NutriBot</button>
    </nav>
</header>

<main>

<section id="vista-imc">

    <section class="card">
        <div class="card-header">
            <div class="icon">ğŸ§®</div>
            <h2>Calculadora de IMC</h2>
            <p>
                Ingresa tus datos para calcular tu Ãndice de Masa Corporal
                y recibir recomendaciones personalizadas
            </p>
        </div>

        <div class="field">
            <label>Edad <span id="edadVal">21</span> aÃ±os</label>
            <input type="range" min="10" max="80" value="21"
                   oninput="edadVal.innerText=this.value">
        </div>

        <div class="field">
            <label>Peso <span id="pesoVal">67.1</span> kg</label>
            <input type="range" min="30" max="120" step="0.1" value="67.1"
                   oninput="pesoVal.innerText=this.value">
        </div>

        <div class="field">
            <label>Altura <span id="alturaVal">1.67</span> m</label>
            <input type="range" min="1.40" max="2.10" step="0.01" value="1.67"
                   oninput="alturaVal.innerText=this.value">
        </div>

        <div class="activity">
            <label>Nivel de Actividad FÃ­sica</label>
            <div class="activity-group">
                <button class="activity-btn active">Sedentario</button>
                <button class="activity-btn">Ligera</button>
                <button class="activity-btn">Moderada</button>
                <button class="activity-btn">Alta</button>
            </div>
        </div>

        <button class="primary-btn" onclick="calcularIMCColab()">
    Calcular mi IMC
</button>


    </section>

</section>

<section id="vista-reco" class="hidden">

    <div class="reco-header">
        <div class="reco-icon">ğŸ´</div>
        <h2>Recomendaciones Personalizadas</h2>
        <p>Plan nutricional adaptado a tu IMC, altura y nivel de actividad fÃ­sica</p>
    </div>

    <div class="reco-main">
        <div class="goal">
            <small>Tu Objetivo</small>
            <h3 id="objetivoReco">Mantener peso saludable y equilibrio nutricional</h3>
        </div>

        <div class="calories-box">
            <small>CalorÃ­as Diarias Sugeridas</small>
            <strong id="caloriasReco">1932 kcal</strong>
        </div>
    </div>

    <div class="meals">
        <div class="meal-card">
            <div class="meal-title">â˜€ï¸ Desayuno</div>
            <small id="horaDesayuno">7:00 - 9:00 AM</small>
            <p id="descDesayuno">Yogurt natural con frutas frescas y granola</p>
            <div class="meal-info">
                <span class="cal" id="calDes">350 Cal</span>
                <span class="prot" id="protDes">18g Prot</span>
            </div>
        </div>

        <div class="meal-card">
            <div class="meal-title">ğŸ½ï¸ Almuerzo</div>
            <small id="horaAlm">12:00 - 2:00 PM</small>
            <p id="descAlm">Pechuga de pollo a la plancha, ensalada y arroz</p>
            <div class="meal-info">
                <span class="cal" id="calAlm">500 Cal</span>
                <span class="prot" id="protAlm">35g Prot</span>
            </div>
        </div>

        <div class="meal-card">
            <div class="meal-title">ğŸŒ™ Cena</div>
            <small id="horaCena">7:00 - 9:00 PM</small>
            <p id="descCena">Pescado al vapor con verduras asadas</p>
            <div class="meal-info">
                <span class="cal" id="calCena">400 Cal</span>
                <span class="prot" id="protCena">30g Prot</span>
            </div>
        </div>
    </div>

    <div class="snacks">
        <h4>ğŸ Snacks Saludables</h4>
        <div class="snack-list" id="snacksReco">
            <span>Frutas frescas variadas</span>
            <span>Almendras (30g)</span>
            <span>Zanahoria con hummus</span>
        </div>
    </div>

    <div class="tips">
        <h4>ğŸ’¡ Consejos Importantes</h4>
        <ul id="tipsReco">
            <li>ğŸ’§ Bebe al menos 2 litros de agua</li>
            <li>ğŸƒ Realiza actividad fÃ­sica regular</li>
            <li>ğŸ˜´ Duerme entre 7-8 horas</li>
            <li>ğŸ“’ Lleva un registro alimenticio</li>
        </ul>
    </div>

</section>

<!-- nutribot -->
<section id="vista-bot" class="hidden">

    <div class="bot-header">
        <div class="bot-icon">ğŸ’¬</div>
        <h2>NutriBot</h2>
        <p>
            Tu asistente inteligente de nutriciÃ³n. PregÃºntame lo que necesites
            o envÃ­a una imagen de alimentos.
        </p>
    </div>

    <!-- chat -->
    <div class="chat-box">

        <div class="message bot">
            Â¡Hola! Soy NutriBot, tu asistente de nutriciÃ³n.
            Puedo ayudarte con consejos nutricionales y analizar imÃ¡genes de alimentos.
            Â¿En quÃ© puedo ayudarte hoy?
        </div>

        <!-- MENSAJES DE COLAB SE INSERTAN AQUÃ -->
        <div id="chat-messages"></div>

    </div>

    <!-- INPUT -->
    <div class="chat-input">
        <button class="img-btn">ğŸ“·</button>
        <input type="text" id="userMessage" placeholder="Escribe tu consulta de nutriciÃ³n...">
        <button class="send-btn">â¤</button>
    </div>

    <!-- FAQ -->
    <div class="faq">
        <h4>Preguntas Frecuentes</h4>
        <div class="faq-list">
            <button>Â¿CuÃ¡nta proteÃ­na necesito?</button>
            <button>Tips para adelgazar</button>
            <button>Mejores snacks saludables</button>
            <button>HidrataciÃ³n recomendada</button>
            <button>NutriciÃ³n pre-entreno</button>
            <button>Desayunos saludables</button>
        </div>
    </div>

</section>

</main>

<script>
const API_URL = "http://localhost:5000"; 
// âš ï¸ cambia esto por la URL pÃºblica de tu Colab (ngrok / cloudflare)

/* ============================= */
/* CALCULAR IMC â†’ COLAB */
/* ============================= */
async function calcularIMCColab() {

    const data = {
        edad: parseInt(document.getElementById("edadVal").innerText),
        peso: parseFloat(document.getElementById("pesoVal").innerText),
        altura: parseFloat(document.getElementById("alturaVal").innerText),
        actividad: document.querySelector(".activity-btn.active").innerText
    };

    try {
        const res = await fetch(`${API_URL}/calcular-imc`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await res.json();

        // ğŸ‘‰ RESULTADOS DESDE COLAB
        document.getElementById("objetivoReco").innerText = result.objetivo;
        document.getElementById("caloriasReco").innerText = result.calorias + " kcal";

        // Comidas
        document.getElementById("descDesayuno").innerText = result.desayuno.descripcion;
        document.getElementById("calDes").innerText = result.desayuno.calorias + " Cal";
        document.getElementById("protDes").innerText = result.desayuno.proteinas + "g Prot";

        document.getElementById("descAlm").innerText = result.almuerzo.descripcion;
        document.getElementById("calAlm").innerText = result.almuerzo.calorias + " Cal";
        document.getElementById("protAlm").innerText = result.almuerzo.proteinas + "g Prot";

        document.getElementById("descCena").innerText = result.cena.descripcion;
        document.getElementById("calCena").innerText = result.cena.calorias + " Cal";
        document.getElementById("protCena").innerText = result.cena.proteinas + "g Prot";

        // Snacks
        const snacksDiv = document.getElementById("snacksReco");
        snacksDiv.innerHTML = "";
        result.snacks.forEach(snack => {
            snacksDiv.innerHTML += `<span>${snack}</span>`;
        });

        // Tips
        const tipsDiv = document.getElementById("tipsReco");
        tipsDiv.innerHTML = "";
        result.tips.forEach(tip => {
            tipsDiv.innerHTML += `<li>${tip}</li>`;
        });

        // ğŸ‘‰ CAMBIAR DE VISTA
        mostrarVista("reco");

    } catch (error) {
        alert("Error al conectar con Colab");
        console.error(error);
    }
}

function mostrarVista(vista) {
    // Oculta todas las vistas
    document.querySelectorAll("section[id^='vista-']")
        .forEach(v => v.classList.add("hidden"));

    // Muestra la vista seleccionada
    document.getElementById("vista-" + vista).classList.remove("hidden");

    // Quita clase active de todos los botones
    document.querySelectorAll(".nav-btn").forEach(b => b.classList.remove("active"));

    // AÃ±ade clase active al botÃ³n correspondiente
    document.querySelector(`.nav-btn[onclick="mostrarVista('${vista}')"]`).classList.add("active");
}

// Opcional: mostrar la primera vista al cargar la pÃ¡gina
document.addEventListener("DOMContentLoaded", () => mostrarVista("imc"));

</script>


</body>
</html>
